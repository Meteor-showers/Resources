function convertToJsDelivr(){const match=document.getElementById("githubUrl").value.match(/https:\/\/github\.com\/([^\/]+)\/([^\/]+)\/blob\/([^\/]+)\/(.+)/);if(match){const jsDelivrUrl=`https://cdn.jsdelivr.net/gh/${match[1]}/${match[2]}@${match[3]}/${match[4]}`;document.getElementById("result").innerHTML=`<div class="result-container"><p>转换后的jsDelivr链接：</p><button class="copy-btn" onclick="copyToClipboard('${jsDelivrUrl}', this)">复制</button><button class="purge-btn" onclick="purgeCDN('${jsDelivrUrl}', this)">刷新cdn</button></div><a href="${jsDelivrUrl}" target="_blank">${jsDelivrUrl}</a>`;document.getElementById("result").style.display="block"}else{document.getElementById("result").innerHTML="<p>请输入有效的GitHub文件地址。💣💣💣</p>";document.getElementById("result").style.display="block";setTimeout(()=>{document.getElementById("result").style.display="none"},1e3)}}function copyToClipboard(text,button){navigator.clipboard.writeText(text).then(()=>{button.innerText="已复制";toggleButtonState(button)}).catch(err=>{alert("复制失败，请手动复制")})}function purgeCDN(url,button){const purgeUrl=url.replace("https://cdn.jsdelivr.net/","https://purge.jsdelivr.net/");fetch(purgeUrl,{method:'GET'}).then(response=>response.json()).then(data=>{if(data.status==="finished"){button.innerText="刷新完成"}else{alert("刷新失败，请稍后再试")}toggleButtonState(button)}).catch(err=>{alert("刷新失败，请稍后再试");toggleButtonState(button)})}function clearResult(){if(document.getElementById("githubUrl").value===""){document.getElementById("result").style.display="none"}else{document.getElementById("result").innerHTML=""}}function handleKeyPress(event){if(event.key==="Enter"){convertToJsDelivr()}}function getQueryParams(){const params=new URLSearchParams(window.location.search);for(const param of params.entries()){if(param[0].startsWith("https://github.com/")){return param[0]}}return""}function toggleButtonState(button){button.classList.add("clicked");setTimeout(()=>{button.classList.remove("clicked")},500)}window.onload=()=>{const githubUrl=getQueryParams();if(githubUrl){document.getElementById("githubUrl").value=githubUrl;convertToJsDelivr()}};